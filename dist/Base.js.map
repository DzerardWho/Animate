{"version":3,"file":"Base.js","sources":["../src/NOOP.ts","../src/Matrix.ts","../src/Timeline/Timeframe.ts","../src/Timeline/EasingFunctions.ts","../src/Timeline/Data.ts","../src/Timeline/Element.ts","../src/Timeline/TimeframeLayer.ts","../src/Timeline/Timeline.ts","../src/Timeline/TimelineInstance.ts","../src/Programs.ts","../src/Renderable/Renderable.ts","../src/Color.ts","../src/Renderable/Rectangle.ts","../src/AssetManagement/Spritesheet.ts","../src/BufferInfo.ts","../src/Renderable/Sprite.ts","../src/AssetManagement/Item.ts","../src/AssetManagement/AssetLoader.ts","../src/AssetManagement/AssetMenager.ts","../src/Renderer.ts","../src/DebugGl.ts","../src/Base.ts"],"sourcesContent":["export function NOOP() {}","import { vec2, Matrix } from \"./types\";\r\n\r\nconst degToRad = Math.PI / 180;\r\n\r\nexport function computeMatrix(_in: Matrix, out: Matrix, pos: vec2, scale: vec2, width: number, height: number, trans: vec2, angle: number, padding: vec2): Matrix {\r\n    let [a, b, , d, e, , g, h] = _in;\r\n    let x = pos.x, y = pos.y, px = trans.x, py = trans.y, sx = scale.x, sy = scale.y;\r\n    angle *= degToRad;\r\n    let s = Math.sin(angle),\r\n        c = Math.cos(angle);\r\n    let pax = 0,\r\n        pay = 0;\r\n\r\n    if (padding) {\r\n        pax = padding.x;\r\n        pay = padding.y;\r\n    }\r\n\r\n    out[0] = sx * (c * a + s * d) * width;\r\n    out[1] = sx * (c * b + s * e) * width;\r\n    out[3] = sy * (c * d - s * a) * height;\r\n    out[4] = sy * (c * e - s * b) * height;\r\n    out[6] = a * (sy * s * (py - pay) + sx * c * (pax - px) + px + x) +\r\n        d * (sy * c * (pay - py) + sx * s * (pax - px) + py + y) +\r\n        g;\r\n    out[7] = b * (sy * s * (py - pay) + sx * c * (pax - px) + px + x) +\r\n        e * (sy * c * (pay - py) + sx * s * (pax - px) + py + y) +\r\n        h;\r\n    out[2] = out[5] = 0;\r\n    out[8] = 1;\r\n\r\n    return out;\r\n}\r\n\r\nexport function projectionMatrix(\r\n    out: Matrix,\r\n    width: number,\r\n    height: number\r\n): Matrix {\r\n    out[0] = 2 / width;\r\n    out[1] = 0;\r\n    out[2] = 0;\r\n    out[3] = 0;\r\n    out[4] = -2 / height;\r\n    out[5] = 0;\r\n    out[6] = -1;\r\n    out[7] = 1;\r\n    out[8] = 1;\r\n    return out;\r\n}\r\n\r\nexport function createProjection(width: number, height: number): Matrix {\r\n    return new Float32Array([2 / width, 0, 0, 0, -2 / height, 0, -1, 1, 1]);\r\n}\r\n\r\nexport function identity() {\r\n    return new Float32Array([1, 0, 0, 0, 1, 0, 0, 0, 1]);\r\n}\r\n","import { Element } from './Element'\r\n\r\nexport class Timeframe {\r\n    start: number;\r\n    duration: number;\r\n    elements: Array<Element>;\r\n\r\n    constructor(start: number, duration: number) {\r\n        this.start = start;\r\n        this.duration = duration;\r\n        this.elements = [];\r\n    }\r\n\r\n    in(frame: number) {\r\n        return (this.start >= frame && frame <= this.start + this.duration);\r\n    }\r\n\r\n    // split(splitPoint: number) {\r\n    //     let t = splitPoint - this.start;\r\n    //     let s = new Timeframe(splitPoint, this.duration - t);\r\n    //     this.duration = t;\r\n    //     s.addElements(this.elements);\r\n    // }\r\n\r\n    addElement(element: Element) {\r\n        this.elements.push(element);\r\n    }\r\n\r\n    addElements(elements: Array<Element>) {\r\n        for (let i of elements) {\r\n            this.addElement(i);\r\n        }\r\n    }\r\n}\r\n","export function Linear(a: number) {\r\n    return a;\r\n}\r\n\r\nexport function easeInQuad(a: number) {\r\n    return a ** 2;\r\n}\r\n\r\nexport function easeOutQuad(a: number) {\r\n    return -a * (a - 2);\r\n}\r\n\r\nexport function easeInOutQuad(a: number) {\r\n    if (a < 0.5) {\r\n        return 2 * a ** 2;\r\n    } else {\r\n        a = a * 2 - 1;\r\n        return -0.5 * (a * (a - 2) - 1);\r\n    }\r\n}\r\n\r\nexport function easeInCubic(a: number) {\r\n    return a ** 3;\r\n}\r\n\r\nexport function easeOutCubic(a: number) {\r\n    return (a - 1) ** 3 + 1;\r\n}\r\n\r\nexport function easeInOutCubic(a: number) {\r\n    a *= 2;\r\n    if (a < 1) {\r\n        return 0.5 * a ** 3;\r\n    } else {\r\n        return 0.5 * ((a - 2) ** 3 + 2);\r\n    }\r\n}\r\n\r\nexport function easeInExpo(a: number) {\r\n    if (a === 0) {\r\n        return 0;\r\n    }\r\n    return 2 ** (10 * (a - 1));\r\n}\r\n\r\nexport function easeOutExpo(a: number) {\r\n    if (a === 1) {\r\n        return 1;\r\n    }\r\n    return -(2 ** (-10 * a)) + 1;\r\n}\r\n\r\nexport function easeInOutExpo(a: number) {\r\n    if (a === 0) {\r\n        return 0;\r\n    } else if (a === 1) {\r\n        return 1;\r\n    } else {\r\n        a *= 2;\r\n        if (a < 1) {\r\n            return 0.5 * 2 ** (10 * (a - 1));\r\n        } else {\r\n            a -= 1;\r\n            return 0.5 * (-1 * (2 ** (-10 * a)) + 2);\r\n        }\r\n    }\r\n}","import { vec2, _Data } from '../types'\r\n\r\nexport class Data {\r\n    pos: vec2;\r\n    angle: number = 0;\r\n    scale: vec2;\r\n    transformationPoint: vec2;\r\n    alpha: number = 1;\r\n\r\n    constructor(data: _Data | null) {\r\n        this.pos = { x: 0, y: 0 };\r\n        this.scale = { x: 1, y: 1 };\r\n        this.transformationPoint = { x: 0, y: 0 };\r\n\r\n        if (data) {\r\n            if (data.pos){\r\n                if (data.pos.x) {\r\n                    this.pos.x = data.pos.x;\r\n                }\r\n                if (data.pos.y) {\r\n                    this.pos.y = data.pos.y;\r\n                }\r\n            }\r\n            this.angle = typeof data.angle === 'undefined' ? 0 : data.angle;\r\n            if (data.scale) {\r\n                if (data.scale.x) {\r\n                    this.scale.x = data.scale.x;\r\n                }\r\n                if (data.scale.y) {\r\n                    this.scale.y = data.scale.y;\r\n                }\r\n            }\r\n            if (data.transformationPoint) {\r\n                if (data.transformationPoint.x) {\r\n                    this.transformationPoint.x = data.transformationPoint.x;\r\n                }\r\n                if (data.transformationPoint.y) {\r\n                    this.transformationPoint.y = data.transformationPoint.y;\r\n                }\r\n            }\r\n            this.alpha = typeof data.alpha === 'undefined' ? 1 : data.alpha;\r\n        }\r\n    }\r\n\r\n    getData(to: Data, progress: number) {\r\n        let alpha = this.alpha + (to.alpha - this.alpha) * progress;\r\n        if (alpha < 0) {\r\n            alpha = 0;\r\n        } else if (alpha > 1) {\r\n            alpha = 1\r\n        }\r\n        return {\r\n            pos: {\r\n                x: this.pos.x + (to.pos.x - this.pos.x) * progress,\r\n                y: this.pos.y + (to.pos.y - this.pos.y) * progress\r\n            },\r\n            angle: this.angle + (to.angle - this.angle) * progress,\r\n            scale: {\r\n                x: this.scale.x + (to.scale.x - this.scale.x) * progress,\r\n                y: this.scale.y + (to.scale.y - this.scale.y) * progress,\r\n            },\r\n            transformationPoint: {\r\n                x: this.transformationPoint.x + (to.transformationPoint.x - this.transformationPoint.x) * progress,\r\n                y: this.transformationPoint.y + (to.transformationPoint.y - this.transformationPoint.y) * progress,\r\n            },\r\n            alpha: alpha\r\n        }\r\n    }\r\n}","import { Linear } from './EasingFunctions'\r\nimport { computeMatrix, identity } from '../Matrix'\r\nimport { Data } from './Data';\r\nimport { timeElement, _Data, Matrix } from '../types';\r\n\r\nexport class Element {\r\n    object: timeElement;\r\n    motion: boolean;\r\n    continueFrom: number;\r\n    from: Data;\r\n    to: Data | null;\r\n    val: Data | null;\r\n    transMatrix: Float32Array;\r\n    easing: ((arg0: number) => number);\r\n\r\n    constructor(obj: timeElement, from: _Data, to?: _Data | null, continueFromFrame: number = 0) {\r\n        this.motion = to ? true : false;\r\n        this.easing = this.motion ? Linear : null;\r\n        this.to = this.motion ? new Data(to) : null;\r\n        // this.val = this.motion ? new Data(null) : null;\r\n        this.from = new Data(from);\r\n        this.object = obj;\r\n\r\n        this.transMatrix = identity();\r\n\r\n        this.continueFrom = continueFromFrame || 0;\r\n    }\r\n\r\n    update(frame: number) {\r\n        this.object.update(frame);\r\n    }\r\n\r\n    draw(parentMatrix: Matrix, alpha: number, frame: number, duration: number) {\r\n        let progress;\r\n        frame += this.continueFrom;\r\n        if (frame > duration) {\r\n            if (this.object.loop) {\r\n                frame %= duration;\r\n            } else {\r\n                frame = duration;\r\n            }\r\n        }\r\n        progress = frame / duration;\r\n        let data = this.motion ? this.from.getData(this.to, this.easing(progress)) : this.from;\r\n        alpha *= data.alpha;\r\n        if (!alpha){\r\n            return;\r\n        }\r\n        computeMatrix(parentMatrix, this.transMatrix, data.pos, data.scale, this.object.width || 1, this.object.height || 1, data.transformationPoint, data.angle, this.object.padding);\r\n        this.object.draw(this.transMatrix, alpha, frame);\r\n    }\r\n}","import { Timeframe } from './Timeframe'\r\nimport { Element } from './Element'\r\nimport { _Data, timeElement } from '../types'\r\n\r\nexport class TimeframeLayer {\r\n    frames: Array<Timeframe>;\r\n    duration: number;\r\n\r\n    constructor() {\r\n        this.frames = [];\r\n        this.duration = 0;\r\n    }\r\n\r\n    addElement(obj: timeElement, from: _Data, to: _Data = null, start: number, duration: number, continueFrom: number = 0) {\r\n        // TODO \r\n        // Coś tu nie działa\r\n        if (start + duration > this.duration) {\r\n            this.duration = start + duration;\r\n        }\r\n\r\n        let timeFrame = this.find(start, duration);\r\n        if (timeFrame) {\r\n            timeFrame.addElement(new Element(obj, from, to, continueFrom))\r\n        } else {\r\n            let t = new Timeframe(start, duration);\r\n            t.addElement(new Element(obj, from, to, continueFrom));\r\n            let index = this.findIndex(start, duration);\r\n            if (index === -1) {\r\n                this.frames.push(t);\r\n            } else {\r\n                this.frames.splice(index + 1, 0, t);\r\n            }\r\n        }\r\n    }\r\n\r\n    findByFrame(frame: number) {\r\n        return this.frames.find((val) => {\r\n            return (val.start <= frame && frame < val.start + val.duration);\r\n        });\r\n    }\r\n\r\n    find(start: number, duration: number) {\r\n        return this.frames.find((val) => {\r\n            return (val.start === start && val.duration === duration)\r\n        });\r\n    }\r\n\r\n    findIndex(start: number, duration: number) {\r\n        return this.frames.findIndex((val) => {\r\n            return (val.start < start)\r\n        });\r\n    }\r\n}\r\n","import { Matrix, timeElement, _Data, vec2, elementData } from '../types'\r\nimport { TimeframeLayer } from './TimeframeLayer';\r\nimport { Timeframe } from './Timeframe';\r\n\r\ninterface lastUsedData {\r\n    obj?: any;\r\n    from?: _Data;\r\n    nextFrame: number;\r\n    layer: number;\r\n}\r\n\r\nexport class Timeline {\r\n    loop: boolean;\r\n    layers: Array<TimeframeLayer>;\r\n    lastUsed: lastUsedData;\r\n    duration: number;\r\n    padding: vec2;\r\n    width: number;\r\n    height: number;\r\n\r\n    constructor(loop: boolean = false, initLayers?: number) {\r\n        this.loop = loop;\r\n        this.layers = [];\r\n        this.duration = 0;\r\n        this.createLayer();\r\n        this.createMultipleLayers(initLayers - 1);\r\n        this.lastUsed = {\r\n            nextFrame: 0,\r\n            layer: 0\r\n        };\r\n    }\r\n\r\n    createLayer() {\r\n        this.layers.push(new TimeframeLayer);\r\n        return this;\r\n    }\r\n\r\n    createMultipleLayers(count: number) {\r\n        for (let i = 0; i < count; ++i) {\r\n            this.createLayer();\r\n        }\r\n        return this;\r\n    }\r\n\r\n    addObjectToLayer(obj: timeElement, from: _Data, to: _Data, start: number, duration: number, layer: number, continueFrom: number = 0) {\r\n        if (layer > this.layers.length - 1) {\r\n            throw new Error(\"Layer out of range\");\r\n        }\r\n\r\n        this.layers[layer].addElement(obj, from, to, start, duration, continueFrom);\r\n\r\n        if (start + duration > this.duration){\r\n            this.duration = start + duration;\r\n        }\r\n\r\n        return this;\r\n    }\r\n\r\n    set(data: elementData, obj?: timeElement) {\r\n        if (!data.data) {\r\n            throw new Error('There is no data to be set.');\r\n        }\r\n\r\n        if (typeof obj !== 'undefined') {\r\n            this.lastUsed.obj = obj;\r\n        } else if (!this.lastUsed.obj) {\r\n            throw new Error('Object is required.');\r\n        }\r\n\r\n        data.duration = data.duration || 1;\r\n\r\n        this.lastUsed.layer = typeof data.layer === 'number' ? data.layer : this.lastUsed.layer;\r\n        // this.lastUsed.layer = data.layer || this.lastUsed.layer;\r\n        // this.lastUsed.nextFrame = data.start || this.lastUsed.nextFrame;\r\n        this.lastUsed.nextFrame = typeof data.start !== 'undefined' ? data.start : this.lastUsed.nextFrame;\r\n        this.lastUsed.from = data.data;\r\n\r\n        if (this.lastUsed.layer > this.layers.length - 1) {\r\n            throw new Error(\"Layer out of range\");\r\n        }\r\n\r\n        this.layers[this.lastUsed.layer].addElement(this.lastUsed.obj, data.data, null, this.lastUsed.nextFrame, data.duration, data.continueFrom);\r\n\r\n        if (this.lastUsed.nextFrame + data.duration > this.duration){\r\n            this.duration = this.lastUsed.nextFrame + data.duration;\r\n        }\r\n\r\n        this.lastUsed.nextFrame += data.duration;\r\n        return this;\r\n    }\r\n\r\n    to(data: elementData, obj?: timeElement) {\r\n        if (!data.data) {\r\n            throw new Error('There is no data to be set.');\r\n        }\r\n\r\n        if (typeof obj !== 'undefined') {\r\n            this.lastUsed.obj = obj;\r\n        } else if (!this.lastUsed.obj) {\r\n            throw new Error('Object is required.');\r\n        }\r\n\r\n        data.duration = data.duration || 1;\r\n\r\n        this.lastUsed.nextFrame = typeof data.start !== 'undefined' ? data.start : this.lastUsed.nextFrame;\r\n        this.lastUsed.layer = typeof data.layer === 'number' ? data.layer : this.lastUsed.layer;\r\n\r\n        if (this.lastUsed.layer > this.layers.length - 1) {\r\n            throw new Error(\"Layer out of range\");\r\n        }\r\n\r\n        this.layers[this.lastUsed.layer].addElement(this.lastUsed.obj, this.lastUsed.from, data.data, this.lastUsed.nextFrame, data.duration, data.continueFrom);\r\n\r\n        if (this.lastUsed.nextFrame + data.duration > this.duration){\r\n            this.duration = this.lastUsed.nextFrame + data.duration;\r\n        }\r\n\r\n        this.lastUsed.nextFrame += data.duration;\r\n        this.lastUsed.from = data.data;\r\n        return this;\r\n    }\r\n\r\n    fromTo(data: elementData, obj?: timeElement) {\r\n        if (!(data.data && data.to)) {\r\n            throw new Error('There is no data to be set.');\r\n        }\r\n\r\n        if (typeof obj !== 'undefined') {\r\n            this.lastUsed.obj = obj;\r\n        } else if (!this.lastUsed.obj) {\r\n            throw new Error('Object is required.');\r\n        }\r\n\r\n        data.duration = data.duration || 1;\r\n\r\n        this.lastUsed.nextFrame = typeof data.start !== 'undefined' ? data.start : this.lastUsed.nextFrame;\r\n        this.lastUsed.layer = typeof data.layer === 'number' ? data.layer : this.lastUsed.layer;\r\n\r\n        if (this.lastUsed.layer > this.layers.length - 1) {\r\n            throw new Error(\"Layer out of range\");\r\n        }\r\n\r\n        this.layers[this.lastUsed.layer].addElement(this.lastUsed.obj, data.data, data.to, this.lastUsed.nextFrame, data.duration, data.continueFrom);\r\n\r\n        if (this.lastUsed.nextFrame + data.duration > this.duration){\r\n            this.duration = this.lastUsed.nextFrame + data.duration;\r\n        }\r\n\r\n        this.lastUsed.nextFrame += data.duration;\r\n        this.lastUsed.from = data.to;\r\n        return this;\r\n    }\r\n\r\n    toSet(data: elementData, dur?:number, obj?: timeElement){\r\n        this.to(data, obj);\r\n        data.duration = dur;\r\n        this.set(data);\r\n    }\r\n\r\n    fromToSet(data: elementData, dur?:number, obj?: timeElement){\r\n        this.fromTo(data, obj);\r\n        data.data = data.to;\r\n        data.duration = dur;\r\n        this.set(data);\r\n    }\r\n\r\n    update(frame: number) {\r\n        let timeFrame, _frame;\r\n        if (this.loop) {\r\n            frame %= this.duration;\r\n        } else if (frame >= this.duration) {\r\n            frame = this.duration - 1;\r\n        }\r\n        this.layers.forEach((layer) => {\r\n            timeFrame = layer.findByFrame(frame);\r\n            if (!timeFrame) {\r\n                return;\r\n            }\r\n            _frame = frame - timeFrame.start;\r\n            timeFrame.elements.forEach((element) => {\r\n                element.update(_frame);\r\n            });\r\n        });\r\n    }\r\n\r\n    draw(matrix: Matrix, alpha: number = 1, frame: number) {\r\n        if (alpha) {\r\n            let timeFrame: Timeframe | null, _frame;\r\n            if (this.loop) {\r\n                frame %= this.duration;\r\n            } else if (frame >= this.duration) {\r\n                frame = this.duration - 1;\r\n            }\r\n            this.layers.forEach((layer) => {\r\n                timeFrame = layer.findByFrame(frame);\r\n                if (!timeFrame) {\r\n                    return;\r\n                }\r\n                _frame = frame - timeFrame.start;\r\n                timeFrame.elements.forEach((element) => {\r\n                    element.draw(matrix, alpha, _frame, timeFrame.duration);\r\n                });\r\n            });\r\n        }\r\n    }\r\n}","import { Timeline } from './Timeline'\r\nimport { Base } from '../Base';\r\nimport { Color } from '../Color';\r\nimport { Matrix, vec2 } from '../types';\r\n// import * as twgl from '../twgl.js/dist/4.x/twgl';\r\n\r\nexport class TimelineInstance {\r\n    gl: WebGLRenderingContext;\r\n    base: Base;\r\n    timeline: Timeline;\r\n    colorTimeline: Timeline;\r\n    maskTimeline: Timeline;\r\n    frame: number;\r\n    color: Color;\r\n    projectionMatrix: Matrix;\r\n    program: twgl.ProgramInfo;\r\n    bufferInfo: twgl.BufferInfo;\r\n    texture: WebGLTexture;\r\n    framebuffer: WebGLFramebuffer;\r\n    prevFramebuffer: WebGLFramebuffer;\r\n    uniforms: object;\r\n    width: number;\r\n    height: number;\r\n    padding: vec2;\r\n\r\n    draw: ((arg1: Matrix, arg2: number) => void);\r\n\r\n    constructor(base: Base, timeline: Timeline, useColor: Color = null, useMask: boolean = false) {\r\n        this.frame = 0;\r\n        this.base = base;\r\n        this.timeline = timeline;\r\n        this.gl = base.gl;\r\n        this.projectionMatrix = base.projectionMatrixAndSize;\r\n        // if (useColor && useMask) {\r\n        //     this.program = base.colorAndMaskProgram;\r\n        //     this.draw = this.drawAndModify;\r\n        //     this.uniforms = {uSampler: this.texture, uTransMatrix: this.projectionMatrix};\r\n        //     this.setUpForFramebuffer();\r\n        // } else \r\n        if (useColor) {\r\n            this.setUpForFramebuffer();\r\n            this.program = base.colorProgram;\r\n            this.draw = this.drawAndModify;\r\n            this.color = useColor;\r\n            this.uniforms = {uSampler: this.texture, uTransMatrix: this.projectionMatrix};\r\n        // } else if (useMask) {\r\n        //     this.program = base.maskProgram;\r\n        //     this.draw = this.drawAndModify;\r\n        //     this.uniforms = {uSampler: this.texture, uTransMatrix: this.projectionMatrix};\r\n        //     this.setUpForFramebuffer();\r\n        } else {\r\n            this.draw = this.basicDraw;\r\n        }\r\n    }\r\n\r\n    reset() {\r\n        this.frame = 0;\r\n    }\r\n\r\n    update() {\r\n        ++this.frame;\r\n        this.timeline.update(this.frame);\r\n    }\r\n\r\n    private setUpForFramebuffer() {\r\n        this.texture = this.gl.createTexture();\r\n        this.gl.bindTexture(this.gl.TEXTURE_2D, this.texture);\r\n\r\n        this.gl.texParameteri(this.gl.TEXTURE_2D, this.gl.TEXTURE_WRAP_S, this.gl.CLAMP_TO_EDGE);\r\n        this.gl.texParameteri(this.gl.TEXTURE_2D, this.gl.TEXTURE_WRAP_T, this.gl.CLAMP_TO_EDGE);\r\n        this.gl.texParameteri(this.gl.TEXTURE_2D, this.gl.TEXTURE_MIN_FILTER, this.gl.NEAREST);\r\n        this.gl.texParameteri(this.gl.TEXTURE_2D, this.gl.TEXTURE_MAG_FILTER, this.gl.NEAREST);\r\n        this.gl.texImage2D(this.gl.TEXTURE_2D, 0, this.gl.RGBA, this.base.canvas.width, this.base.canvas.height, 0, this.gl.RGBA, this.gl.UNSIGNED_BYTE, null);\r\n    \r\n        this.framebuffer = this.gl.createFramebuffer();\r\n        this.gl.bindFramebuffer(this.gl.FRAMEBUFFER, this.framebuffer);\r\n        this.gl.framebufferTexture2D(this.gl.FRAMEBUFFER, this.gl.COLOR_ATTACHMENT0, this.gl.TEXTURE_2D, this.texture, 0);\r\n        this.gl.bindFramebuffer(this.gl.FRAMEBUFFER, null);\r\n\r\n        this.bufferInfo = this.base.defaultBufferInfo;\r\n    }\r\n\r\n    private basicDraw(matrix: Matrix, alpha: number) {\r\n        this.timeline.draw(matrix, alpha, this.frame);\r\n    }\r\n\r\n    private drawAndModify(matrix: Matrix, alpha: number) {\r\n        this.prevFramebuffer = this.base.lastUsedFramebuffer;\r\n        this.base.lastUsedFramebuffer = this.framebuffer;\r\n\r\n        this.gl.bindTexture(this.gl.TEXTURE_2D, this.texture);\r\n\r\n        this.clear();\r\n        this.basicDraw(matrix, 1);\r\n\r\n        this.base.lastUsedFramebuffer = this.prevFramebuffer;\r\n        if (this.base.lastUsedProgram !== this.program){\r\n            this.base.lastUsedProgram = this.program;\r\n        }\r\n        \r\n        twgl.setBuffersAndAttributes(this.gl, this.program, this.bufferInfo);\r\n        this.uniforms['uColor'] = this.color.mixAlpha(alpha);\r\n        twgl.setUniforms(this.program, this.uniforms);\r\n\r\n        this.gl.drawArrays(this.gl.TRIANGLE_STRIP, 0, 4);\r\n    }\r\n\r\n    get loop(){\r\n        return this.timeline.loop;\r\n    }\r\n\r\n    get duration() {\r\n        return this.timeline.duration;\r\n    }\r\n\r\n    clear() {\r\n        this.gl.clearColor(0,0,0,0);\r\n        this.gl.clear(this.gl.COLOR_BUFFER_BIT);\r\n    }\r\n}","export const colorShapeVertexShader = `precision mediump float;\r\n\r\nattribute vec2 aPos;\r\n\r\nuniform mat3 uTransMatrix;\r\n\r\nvoid main(){\r\n    gl_Position = vec4((uTransMatrix * vec3(aPos, 1.0)).xy, 0.0, 1.0);\r\n}`;\r\n\r\nexport const colorShapeFragmentShader = `precision mediump float;\r\n\r\nuniform vec4 uColor;\r\n\r\nvoid main(){\r\n    vec4 color = uColor;\r\n    color.rgb *= color.a;\r\n    gl_FragColor = color;\r\n}`;\r\n\r\nexport const spriteVertexShader = `precision mediump float;\r\n\r\nattribute vec2 aPos;\r\nattribute vec2 aTexCoords;\r\n\r\nuniform mat3 uTransMatrix;\r\n\r\nvarying vec2 vTexCoord;\r\n\r\nvoid main(){\r\n    vTexCoord = aTexCoords;\r\n    gl_Position = vec4((uTransMatrix * vec3(aPos, 1.0)).xy, 0.0, 1.0);\r\n}`;\r\n\r\nexport const spriteFragmentShader = `precision mediump float;\r\n\r\nvarying vec2 vTexCoord;\r\nuniform float uAlpha;\r\nuniform sampler2D uSampler;\r\n\r\nvoid main(){\r\n    vec4 color = texture2D(uSampler, vTexCoord);\r\n    color.a *= uAlpha;\r\n    color.rgb *= color.a;\r\n\tgl_FragColor = color;\r\n}`;\r\n\r\nexport const timelineVertexShader = `precision mediump float;\r\n\r\nattribute vec2 aPos;\r\n\r\nuniform mat3 uTransMatrix;\r\n\r\nvarying vec2 vTexCoord;\r\n\r\nvoid main(){\r\n    vTexCoord = aPos;\r\n    gl_Position = vec4((uTransMatrix * vec3(aPos, 1.0)).xy, 0.0, 1.0);\r\n}`;\r\n\r\nexport const colorTimelineFragmentShader = `precision mediump float;\r\n\r\nvarying vec2 vTexCoord;\r\nuniform vec4 uColor;\r\nuniform sampler2D uSampler;\r\n\r\nvoid main(){\r\n    vec4 color = uColor;\r\n    color *= texture2D(uSampler, vTexCoord).a;\r\n    gl_FragColor = color;\r\n}`;\r\n\r\nexport const maskTimelineFragmentShader = `precision mediump float;\r\n\r\nvarying vec2 vTexCoord;\r\nuniform float uAlpha;\r\nuniform sampler2D uSampler;\r\nuniform sampler2D uMask;\r\n\r\nvoid main(){\r\n    vec4 color = texture2D(uSampler, vTexCoord);\r\n    color.a *= uAlpha * texture2D(uMask, vTexCoord).a;\r\n    color.rgb *= color.a;\r\n\tgl_FragColor = color;\r\n}`;\r\n\r\nexport const colorAndMaskTimelineFragmentShader = `precision mediump float;\r\n\r\nvarying vec2 vTexCoord;\r\nuniform vec4 uColor;\r\nuniform sampler2D uSampler;\r\nuniform sampler2D uMask;\r\n\r\nvoid main(){\r\n    vec4 color = texture2D(uSampler, vTexCoord);\r\n    color.a *= uColor.a * texture2D(uMask, vTexCoord).r;\r\n    color.rgb *= color.a;\r\n\tgl_FragColor = color;\r\n}`;","import { Base } from '../Base'\r\nimport { vec2 } from '../types';\r\n// import { ProgramInfo, BufferInfo } from '../twgl.js/dist/4.x/twgl';\r\nimport { NOOP } from '../NOOP';\r\n\r\nexport class Renderable {\r\n\tunitBuffer: WebGLBuffer;\r\n\tbufferInfo: BufferInfo;\r\n\tprogram: ProgramInfo;\r\n\tgl: WebGLRenderingContext;\r\n\tbase: Base;\r\n\tloop: boolean;\r\n\twidth: number;\r\n\theight: number;\r\n\t\r\n\tpadding: vec2;\r\n\r\n\tupdate: () => void;\r\n\r\n\tconstructor(\r\n\t\tbase: Base,\r\n\t\tw: number,\r\n\t\th: number\r\n\t) {\r\n\t\tthis.base = base;\r\n\t\tthis.gl = base.gl;\r\n\t\tthis.loop = true;\r\n\t\t// this.unitBuffer = base.unitBuffer;\r\n\r\n\t\tthis.width = w;\r\n\t\tthis.height = h;\r\n\r\n\t\tthis.update = NOOP;\r\n\t}\r\n}\r\n","import { _Color } from \"./types\";\r\n\r\nexport class Color {\r\n\tprivate _r: number;\r\n\tprivate _g: number;\r\n\tprivate _b: number;\r\n\tprivate _a: number;\r\n\tprivate _buffer: Float32Array;\r\n\tprivate dirty: boolean;\r\n\r\n\tconstructor(r?: number | _Color, g?: number, b?: number, a?: number) {\r\n\t\tif (typeof r == \"object\") {\r\n\t\t\tthis._r = typeof r[0] === 'number' ? this.abs_val(r[0]) : 1;\r\n\t\t\tthis._g = typeof r[1] === 'number' ? this.abs_val(r[1]) : 1;\r\n\t\t\tthis._b = typeof r[2] === 'number' ? this.abs_val(r[2]) : 1;\r\n\t\t\tthis._a = typeof r[3] === 'number' ? this.abs_val(r[3]) : 1;\r\n\t\t} else {\r\n\t\t\tthis._r = r ? this.abs_val(r) : 1;\r\n\t\t\tthis._g = g ? this.abs_val(g) : 1;\r\n\t\t\tthis._b = b ? this.abs_val(b) : 1;\r\n\t\t\tthis._a = a ? this.abs_val(a) : 1;\r\n\t\t}\r\n\t\tthis._buffer = new Float32Array(this.getColor());\r\n\t}\r\n\r\n\tset r(_c: number) {\r\n\t\tthis._r = this.abs_val(_c);\r\n\t\tthis.dirty = true;\r\n\t}\r\n\r\n\tget r() {\r\n\t\treturn this._r;\r\n\t}\r\n\r\n\tset g(_c: number) {\r\n\t\tthis._g = this.abs_val(_c);\r\n\t\tthis.dirty = true;\r\n\t}\r\n\r\n\tget g() {\r\n\t\treturn this._g;\r\n\t}\r\n\r\n\tset b(_c: number) {\r\n\t\tthis._b = this.abs_val(_c);\r\n\t\tthis.dirty = true;\r\n\t}\r\n\r\n\tget b() {\r\n\t\treturn this._b;\r\n\t}\r\n\r\n\tset a(_c: number) {\r\n\t\tthis._a = this.abs_val(_c);\r\n\t\tthis.dirty = true;\r\n\t}\r\n\r\n\tget a() {\r\n\t\treturn this._a;\r\n\t}\r\n\r\n\tprivate abs_val(v: number) {\r\n\t\treturn v <= 0 ? (v >= -1 ? -v : 0) : v > 255 ? (v % 255) / 255 : v / 255;\r\n\t}\r\n\r\n\tget color() {\r\n\t\treturn [this._r, this._g, this._b, this._a];\r\n\t}\r\n\r\n\tset color(c: _Color) {\r\n\t\tthis.r = c[0];\r\n\t\tthis.g = c[1];\r\n\t\tthis.b = c[2];\r\n\t\tthis.a = c[3] || -this.a;\r\n\t}\r\n\r\n\tgetColor() {\r\n\t\treturn [this._r, this._g, this._b, this._a];\r\n\t}\r\n\r\n\tget buffer() {\r\n\t\tif (this.dirty) {\r\n\t\t\tthis._buffer[0] = this._r;\r\n\t\t\tthis._buffer[1] = this._g;\r\n\t\t\tthis._buffer[2] = this._b;\r\n\t\t\tthis._buffer[3] = this._a;\r\n\t\t\tthis.dirty = false;\r\n\t\t}\r\n\t\treturn this._buffer;\r\n\t}\r\n\r\n\tmixAlpha(alpha: number) {\r\n\t\t// this._buffer[3] = this._a * alpha;\r\n\t\tthis.buffer[3] *= alpha;\r\n\t\tthis.dirty = true;\r\n\t\treturn this._buffer;\r\n\t}\r\n}","import { Renderable } from './Renderable'\r\nimport { Color } from '../Color'\r\nimport { Base } from '../Base'\r\nimport { Matrix, _Color } from '../types'\r\n// import { setBuffersAndAttributes, setUniforms } from '../twgl.js/dist/4.x/twgl';\r\n\r\nexport class Rectangle extends Renderable {\r\n\tcolor: Color;\r\n\r\n\tconstructor(\r\n\t\tbase: Base,\r\n\t\tw: number,\r\n\t\th: number,\r\n\t\tc: _Color = [1, 1, 1, 1]\r\n\t) {\r\n\t\tsuper(base, w, h);\r\n\t\tthis.program = base.defaultShapeProgram;\r\n\t\t\r\n\t\tthis.color = new Color(c);\r\n\t\tthis.bufferInfo = base.defaultBufferInfo;\r\n\t}\r\n\r\n\tdraw(matrix: Matrix, alpha: number) {\r\n\t\tif (this.base.lastUsedProgram !== this.program) {\r\n\t\t\tthis.base.lastUsedProgram = this.program;\r\n\t\t}\r\n\r\n\t\ttwgl.setBuffersAndAttributes(this.gl, this.program, this.bufferInfo);\r\n\t\ttwgl.setUniforms(this.program, {uColor: this.color.mixAlpha(alpha), uTransMatrix: matrix, uAlpha: alpha})\r\n\t\tthis.gl.drawArrays(this.gl.TRIANGLE_STRIP, 0, 4);\r\n\t}\r\n}\r\n","import { Base } from \"../Base\";\r\n\r\nexport interface DataElements {\r\n    x: number;\r\n    y: number;\r\n    width: number;\r\n    height: number;\r\n    pad_x: number;\r\n    pad_y: number;\r\n}\r\n\r\nexport interface Data {\r\n    [propName: string]: DataElements;\r\n}\r\n\r\nexport interface _SpritesheetData {\r\n    [propName: string]: Data;\r\n    [propName: number]: Data;\r\n}\r\n\r\nexport interface _Sprite {\r\n    texCoords: WebGLBuffer;\r\n    source: Spritesheet;\r\n    width: number;\r\n    height: number;\r\n    pad_x: number;\r\n    pad_y: number;\r\n}\r\n\r\nexport interface _Spritesheet {\r\n    [propName: string]: _Sprite;\r\n    [propName: number]: _Sprite;\r\n}\r\n\r\nexport class Spritesheet {\r\n    base: Base;\r\n    sprites: _Spritesheet;\r\n    private _texture: WebGLTexture;\r\n    gl: WebGLRenderingContext;\r\n    src: HTMLImageElement | ImageData;\r\n\r\n    constructor(base: Base, data: Data, img: ImageData) {\r\n        this.base = base;\r\n        this.gl = base.gl;\r\n        this.sprites = {};\r\n\r\n        this._texture = null;\r\n        this.src = img;\r\n\r\n        let tmp: WebGLBuffer, x: number, y: number, w: number, h: number;\r\n        for (let i in data) {\r\n            x = data[i].x / img.width;\r\n            w = (data[i].x + data[i].width) / img.width;\r\n            y = data[i].y / img.height;\r\n            h = (data[i].y + data[i].height) / img.height;\r\n\r\n            if (x === 0 && y === 0 && w === 1 && h === 1) {\r\n                tmp = base.unitBuffer;\r\n            } else {\r\n                tmp = this.gl.createBuffer();\r\n                this.gl.bindBuffer(this.gl.ARRAY_BUFFER, tmp);\r\n                this.gl.bufferData(this.gl.ARRAY_BUFFER, new Float32Array([\r\n                    x, y,\r\n                    x, h,\r\n                    w, y,\r\n                    w, h\r\n                ]), this.gl.STATIC_DRAW\r\n                );\r\n            }\r\n            \r\n            this.sprites[i] = ({\r\n                texCoords: tmp,\r\n                source: this,\r\n                width: data[i].width,\r\n                height: data[i].height,\r\n                pad_x: data[i].pad_x || 0,\r\n                pad_y: data[i].pad_y || 0\r\n            });\r\n        }\r\n    }\r\n\r\n    get(index: string | number): _Sprite | undefined {\r\n        return this.sprites[index];\r\n    }\r\n\r\n    get texture(): WebGLTexture {\r\n        if (this._texture === null) {\r\n            this._texture = this.base.loadTexture(this.src, this);\r\n        } else {\r\n            this.base.updateTextureBuffer(this);\r\n        }\r\n        return this._texture;\r\n    }\r\n\r\n    getTexture(): WebGLTexture {\r\n        return this.texture;\r\n    }\r\n\r\n    set texture(buffer: WebGLTexture) {\r\n        this._texture = buffer;\r\n    }\r\n}","// import { BufferInfo } from \"./twgl.js/dist/4.x/twgl\";\r\n\r\nexport function createBufferInfoFromBuffers(gl: WebGLRenderingContext, buffers, srcBufferInto?: BufferInfo): BufferInfo {\r\n    let out = {\r\n        numElements: 0,\r\n        attribs: {}\r\n    };\r\n    if (srcBufferInto){\r\n        for (let i in srcBufferInto.attribs) {\r\n            out.attribs[i] = srcBufferInto.attribs[i];\r\n        }\r\n    }\r\n    for (let i in buffers) {\r\n        out.attribs[i] = {};\r\n        out.attribs[i]['buffer'] = buffers[i];\r\n        out.attribs[i]['numComponents'] = 2;\r\n    }\r\n\r\n    return out;\r\n}","import { Renderable } from './Renderable'\r\nimport { Base } from '../Base'\r\nimport { Matrix, _Color } from '../types'\r\nimport { Spritesheet } from '../AssetManagement/Spritesheet'\r\nimport { createBufferInfoFromBuffers } from '../BufferInfo';\r\n// import * as twgl from '../twgl.js/dist/4.x/twgl';\r\n\r\nexport class Sprite extends Renderable {\r\n\tattribs: Object;\r\n\tuniforms: Object;\r\n\r\n\t_texture: WebGLTexture;\r\n\ttextureCoords: WebGLBuffer;\r\n\tloop: boolean;\r\n\tsrc: Spritesheet | HTMLImageElement | ImageData;\r\n\tgetTexture: (() => WebGLTexture);\r\n\r\n\tconstructor(base: Base, img: ImageData | HTMLImageElement | Spritesheet, index?: string | number) {\r\n\t\tif (!(img instanceof Spritesheet)) {\r\n\t\t\tsuper(base, img.width, img.height);\r\n\r\n\t\t\tthis.bufferInfo = base.defaultSpriteBufferInfo;\r\n\t\t\tthis.getTexture = (() => {\r\n\t\t\t\treturn this.texture;\r\n\t\t\t}).bind(this);\r\n\t\t} else {\r\n\t\t\tif (!index) {\r\n\t\t\t\tthrow new Error('Index is required');\r\n\t\t\t}\r\n\r\n\t\t\tlet sprite = img.get(index);\r\n\t\t\tsuper(base, sprite.width, sprite.height);\r\n\t\t\tthis.bufferInfo = createBufferInfoFromBuffers(this.gl, {aTexCoords: sprite.texCoords}, base.defaultBufferInfo);\r\n\t\t\tthis.getTexture = (() => {\r\n\t\t\t\treturn this.src.getTexture();\r\n\t\t\t}).bind(this);\r\n\t\t\tthis.padding = {x: sprite.pad_x, y: sprite.pad_y};\r\n\t\t}\r\n\t\t\r\n\t\tthis._texture = null;\r\n\t\tthis.src = img;\r\n\t\tthis.loop = true;\r\n\t\tthis.program = base.defaultSpriteProgram;\r\n\t}\r\n\r\n\tdraw(matrix: Matrix, alpha: number) {\r\n\t\tif (this.base.lastUsedProgram !== this.program) {\r\n\t\t\tthis.base.lastUsedProgram = this.program;\r\n\t\t}\r\n\r\n\t\tif (this.base.lastUsedTexture !== this._texture){\r\n\t\t\tthis.base.lastUsedTexture = this._texture;\r\n\t\t}\r\n\r\n\t\ttwgl.setBuffersAndAttributes(this.gl, this.program, this.bufferInfo);\r\n\t\ttwgl.setUniforms(this.program, {uSampler: this.getTexture(), uTransMatrix: matrix, uAlpha: alpha})\r\n\t\tthis.gl.drawArrays(this.gl.TRIANGLE_STRIP, 0, 4);\r\n\t}\r\n\r\n\tget texture(): WebGLTexture {\r\n        if (this._texture === null) {\r\n            this._texture = this.base.loadTexture(this.src, this);\r\n        } else {\r\n            this.base.updateTextureBuffer(this);\r\n        }\r\n        return this._texture;\r\n\t}\r\n\r\n\tset texture(value: WebGLTexture) {\r\n\t\tthis._texture = value;\r\n\t}\r\n}","const recognizedTypes = [\r\n    'image',\r\n    'audio',\r\n    'spritesheet',\r\n    'json',\r\n    'js',\r\n    'anime'\r\n]\r\n\r\nexport let fileExt = new RegExp('.*?\\\\.(png|webp|jpg|jpeg|sp\\\\.json|json|js|anime|wav|mp3|webm)$', 'miu');\r\n\r\nexport interface _Item {\r\n    src: string;\r\n    id: string;\r\n    fileFormat?: string;\r\n    type?: string;\r\n    result?: any;\r\n}\r\n\r\nexport class Item implements _Item {\r\n    src: string;\r\n    id: string;\r\n    result: any;\r\n    type: string;\r\n    fileFormat: string;\r\n\r\n    constructor(id: string, src: string, fileFormat?: string, type?: string, transparent?: boolean) {\r\n        this.id = id;\r\n        this.src = src;\r\n\r\n        if (!fileFormat) {\r\n            let format: any = src.match(fileExt);\r\n            if (!format) {\r\n                throw new Error('Unsupported file type');\r\n            }\r\n            this.fileFormat = format[1];\r\n        } else {\r\n            if (!recognizedTypes.includes(fileFormat)) {\r\n                throw new Error('Unsupported file type');\r\n            }\r\n            this.fileFormat = fileFormat;\r\n        }\r\n\r\n        if (recognizedTypes.includes(type)) {\r\n            this.type = type;\r\n            switch (type) {\r\n                case 'audio':\r\n                    this.result = new Audio();\r\n                    break;\r\n                case 'image':\r\n                    this.result = document.createElement('img');\r\n                    break;\r\n                default:\r\n                    break;\r\n            }\r\n        } else {\r\n            switch (this.fileFormat) {\r\n                case 'png':\r\n                case 'webp':\r\n                case 'jpg':\r\n                case 'jpeg':\r\n                    this.type = 'image';\r\n                    this.result = new Image();\r\n                    break;\r\n                case 'sp.json':\r\n                    this.type = 'spritesheet';\r\n                    break;\r\n                case 'json':\r\n                case 'anime':\r\n                case 'js':\r\n                    this.type = this.fileFormat.toLowerCase();\r\n                    break;\r\n                case 'wav':\r\n                case 'mp3':\r\n                case 'webm':\r\n                    this.type = 'audio';\r\n                    this.result = new Audio();\r\n                    break;\r\n            }\r\n        }\r\n    }\r\n}\r\n","import { _Spritesheet, _Sprite } from \"./Spritesheet\";\r\nimport { Item, _Item } from './Item'\r\n\r\n// Lenovo ideapad 720s - 13rr\r\nexport class AssetLoader {\r\n    downloadQueue: Array<_Item>;\r\n    downloaded: Array<_Item>;\r\n    errors: Array<any>;\r\n    toDownload: number;\r\n    maxRetries: number;\r\n    loaderDiv: HTMLElement;\r\n    xml: boolean;\r\n\r\n\r\n    constructor(xml: boolean = false, maxRetries: number = 3) {\r\n        this.maxRetries = maxRetries;\r\n        this.downloadQueue = [];\r\n        this.downloaded = [];\r\n        this.errors = [];\r\n        this.loaderDiv = document.getElementById('loader');\r\n        this.xml = xml;\r\n\r\n        if (!this.loaderDiv) {\r\n            this.loaderDiv = document.createElement('div');\r\n            this.loaderDiv.style.display = 'none';\r\n            document.body.appendChild(this.loaderDiv);\r\n        }\r\n    }\r\n\r\n    download(mode: number = 0) {\r\n        return new Promise((resolve, reject) => {\r\n            let downloadQueue = mode === 0 ? this.downloadQueue : this.errors;\r\n            this.toDownload = downloadQueue.length;\r\n\r\n            if (downloadQueue.length === 0) {\r\n                resolve(this.downloaded);\r\n            }\r\n\r\n            for (let element of downloadQueue) {\r\n                if (!this.xml && element.type === 'image') {\r\n                    element.result.onload = () => {\r\n                        this.loaderDiv.appendChild(element.result);\r\n\r\n                        this.downloaded.push(element);\r\n                        downloadQueue.splice(downloadQueue.indexOf(element), 1);\r\n                        if (this.isDone()) {\r\n                            resolve(this.downloaded);\r\n                        }\r\n                    }\r\n                    element.result.src = element.src;\r\n                } else {\r\n                    let request = new XMLHttpRequest();\r\n\r\n                    if (element.type === 'image') {\r\n                        request.responseType = 'blob';\r\n                    } else if (element.type === 'audio') {\r\n                        request.responseType = 'arraybuffer';\r\n                    }\r\n\r\n                    request.onload = async () => {\r\n                        if (request.status !== 200) {\r\n                            this.errors.push(element);\r\n                            if (this.isDone()) {\r\n                                resolve(this.downloaded);\r\n                            }\r\n                        }\r\n\r\n                        switch (element.type) {\r\n                            case 'image':\r\n                                await new Promise((resolve) => {\r\n                                    element.result.src = URL.createObjectURL(new Blob([request.response], { type: `image/${element.fileFormat}` }));\r\n                                    element.result.onload = () => {\r\n                                        URL.revokeObjectURL(element.result.src)\r\n                                        this.loaderDiv.appendChild(element.result);\r\n                                        resolve();\r\n                                    };\r\n                                })\r\n                                break;\r\n                            case 'audio':\r\n                                await new Promise((resolve) => {\r\n                                    element.result.src = URL.createObjectURL(new Blob([request.response], { type: `audio/${element.fileFormat}` }));\r\n                                    element.result.onload = () => {\r\n                                        URL.revokeObjectURL(element.result.src)\r\n                                        resolve();\r\n                                    };\r\n                                })\r\n                                break;\r\n                            case 'json':\r\n                            case 'spritesheet':\r\n                                element.result = JSON.parse(request.responseText);\r\n                                break;\r\n                            case 'js':\r\n                                element.result = request.responseText;\r\n                                break;\r\n                            case 'anime':\r\n                                let t = new DOMParser();\r\n                                element.result = t.parseFromString(request.responseText, 'text/xml');\r\n                        }\r\n\r\n                        this.downloaded.push(element);\r\n                        downloadQueue.splice(downloadQueue.indexOf(element), 1);\r\n\r\n                        if (this.isDone()) {\r\n                            resolve(this.downloaded);\r\n                        }\r\n                    }\r\n\r\n                    request.onerror = () => {\r\n                        reject(new Error(`Error while downloading file: ${request.statusText}`));\r\n                    }\r\n\r\n                    request.open('GET', element.src, true);\r\n                    request.send();\r\n                }\r\n            }\r\n        });\r\n    }\r\n\r\n    async retryErrors() {\r\n        if (this.errors.length) {\r\n            for (let i = 0; i < this.maxRetries; ++i) {\r\n                await this.download(1);\r\n\r\n                if (this.isDone()) {\r\n                    return this.downloaded;\r\n                }\r\n            }\r\n            throw new Error('Exceeded max number of retries.');\r\n        }\r\n    }\r\n\r\n    pushFile(id: string, src: string, fileFormat?: string, type?: string, transparent?: boolean) {\r\n        this.downloadQueue.push(new Item(id, src, fileFormat, type, transparent));\r\n    }\r\n\r\n    pushManifest(manifest: Array<_Item>) {\r\n        for (let i of manifest) {\r\n            this.pushFile(i.id, i.src, i.fileFormat, i.type);\r\n        }\r\n    }\r\n\r\n    isDone() {\r\n        return (this.downloaded.length + this.errors.length === this.toDownload);\r\n    }\r\n\r\n    clear() {\r\n        this.downloadQueue.slice(0, this.downloadQueue.length);\r\n        this.downloaded.slice(0, this.downloaded.length);\r\n        this.errors.slice(0, this.errors.length);\r\n    }\r\n}","import { Sprite } from \"../Renderable/Sprite\";\r\nimport { Spritesheet, _Spritesheet, _Sprite } from \"./Spritesheet\";\r\nimport { Rectangle } from \"../Renderable/Rectangle\";\r\nimport { Timeline } from \"../Timeline/Timeline\";\r\nimport { Base } from \"../Base\";\r\nimport { AssetLoader } from \"./AssetLoader\";\r\nimport { Item, fileExt, _Item } from \"./Item\";\r\n\r\ninterface Asset {\r\n    [propname: string]: Sprite | Spritesheet | Rectangle | Timeline;\r\n    [propname: number]: Sprite | Spritesheet | Rectangle | Timeline;\r\n}\r\n\r\nexport class AssetMenager {\r\n    spritesheets: object;\r\n    assets: Asset;\r\n    base: Base;\r\n\r\n    constructor(base: Base) {\r\n        this.base = base;\r\n        this.assets = {};\r\n        this.spritesheets = {};\r\n    }\r\n\r\n    loadAssets(assetLoader: AssetLoader) {\r\n        let assets = assetLoader.downloaded.splice(0, assetLoader.downloaded.length);\r\n\r\n        let img: _Item|Item, data;\r\n        for (let spritesheet of assets.filter((v) => { return v.type === 'spritesheet' })) {\r\n            assets.splice(assets.indexOf(spritesheet), 1);\r\n            for (let sheet in spritesheet.result) {\r\n                img = assets.find((value) => {\r\n                    return value.id === sheet;\r\n                });\r\n                if (!img) {\r\n                    throw new Error('Missing spritesheet');\r\n                }\r\n\r\n                assets.splice(assets.indexOf(img), 1);\r\n                data = spritesheet.result[sheet];\r\n\r\n                sheet.replace(fileExt, '');\r\n                sheet = 'sp_' + sheet;\r\n                this.spritesheets[sheet] = new Spritesheet(this.base, data, img.result);\r\n            }\r\n        }\r\n\r\n        for (let asset of assets) {\r\n            switch (asset.type) {\r\n                case 'image':\r\n                    this.assets[asset.id] = new Sprite(this.base, asset.result);\r\n                    break;\r\n                default:\r\n                    // TODO: reszta zasobów\r\n                    break;\r\n            }\r\n        }\r\n    }\r\n\r\n    createSprite(id: string | number, name?: string | number) {\r\n        let sp, k: _Sprite;\r\n        if (typeof name === 'undefined'){\r\n            name = id;\r\n        }\r\n        for (let i in this.spritesheets) {\r\n            if (k = this.spritesheets[i].get(id)) {\r\n                sp = i;\r\n                break;\r\n            }\r\n        }\r\n\r\n        if (!sp) {\r\n            throw new Error(`There is no image named \"${id}\" in spritesheets.`);\r\n        }\r\n\r\n        return (this.assets[name] = new Sprite(this.base, this.spritesheets[sp], id));\r\n    }\r\n\r\n    createAllSprites() {\r\n        let s: Spritesheet | ImageData;\r\n        for (let i in this.spritesheets) {\r\n            s = this.spritesheets[i];\r\n            for (let id in this.spritesheets[i].sprites) {\r\n                this.assets[id] = new Sprite(this.base, s, id);\r\n            }\r\n        }\r\n    }\r\n\r\n    get(id: string | number) {\r\n        return this.assets[id];\r\n    }\r\n}","import { Timeline } from './Timeline/Timeline'\r\nimport { createProjection } from './Matrix'\r\nimport { Base } from './Base'\r\nimport { Color } from './Color'\r\nimport { Matrix } from './types';\r\nimport { NOOP } from './NOOP';\r\n\r\nexport class Renderer {\r\n    gl: WebGLRenderingContext;\r\n    isPlaying: boolean;\r\n    timing: number;\r\n    timeToNextUpdate: number;\r\n    lastUpdate: number;\r\n    mainTimeline: Timeline;\r\n    updateInterval: number;\r\n    frame: number;\r\n    projectionMatrix: Matrix;\r\n    backgroundColor: Color;\r\n    frameUpdated: boolean;\r\n    lastFrameRequest: number;\r\n\r\n    constructor(base: Base, fps: number, width: number, height: number, bgColor: Color) {\r\n        if (fps <= 0) {\r\n            throw new Error(\"Fps must be a positive number\");\r\n        }\r\n\r\n        this.gl = base.gl;\r\n        this.timing = 1000 / fps;\r\n        this.timeToNextUpdate = this.timing;\r\n        this.lastUpdate = 0;\r\n        this.frame = 0;\r\n        this.lastFrameRequest = null;\r\n        this.mainTimeline = null;\r\n        this.isPlaying = false;\r\n        this.projectionMatrix = createProjection(width, height);\r\n        this.backgroundColor = bgColor;\r\n        this.render = this.render.bind(this);\r\n        this.update = this.update.bind(this);\r\n\r\n        if (!base.debug) {\r\n            this.debugIntervals = NOOP;\r\n        }\r\n    }\r\n\r\n    play() {\r\n        if (!this.isPlaying) {\r\n            this.isPlaying = true;\r\n            this.render();\r\n            this.lastUpdate = performance.now();\r\n            setTimeout(() => {\r\n                this.update();\r\n                // this.updateInterval = setInterval(this.update, this.timing);\r\n            }, this.timeToNextUpdate);\r\n        }\r\n    }\r\n\r\n    pause() {\r\n        if (this.isPlaying) {\r\n            clearInterval(this.updateInterval);\r\n            this.timeToNextUpdate -= performance.now() - this.lastUpdate;\r\n            this.isPlaying = false;\r\n        }\r\n    }\r\n\r\n    debugIntervals(){\r\n        if (this.timeToNextUpdate <= 37 || this.timeToNextUpdate >= 43)\r\n            console.log(this.timeToNextUpdate);\r\n    }\r\n\r\n    async update() {\r\n        // if (this.isPlaying) {\r\n            ++this.frame;\r\n            this.frameUpdated = true;\r\n            // cancelAnimationFrame(this.lastFrameRequest);\r\n            this.lastFrameRequest = requestAnimationFrame(this.render);\r\n            // this.timeToNextUpdate = this.timing;\r\n            this.timeToNextUpdate = this.timeToNextUpdate - (performance.now() - this.lastUpdate - this.timing);\r\n            setTimeout(this.update, this.timeToNextUpdate);\r\n            this.debugIntervals();\r\n            this.lastUpdate = performance.now();\r\n            this.mainTimeline.update(this.frame);\r\n        // }\r\n    }\r\n\r\n    async render() {\r\n        if (!this.mainTimeline) {\r\n            throw new Error(\"There is nothing to render (mainTimeline isn't set)\");\r\n        }\r\n        // if (!(this.frameUpdated && this.isPlaying)) {\r\n        if (!(this.frameUpdated)) {\r\n            return;\r\n        }\r\n        // console.log('render');\r\n        this.frameUpdated = false;\r\n        this.clear();\r\n        this.mainTimeline.draw(this.projectionMatrix, 1, this.frame);\r\n        // if (!this.mainTimeline.loop && this.frame >= this.mainTimeline.duration - 1){\r\n        //     this.pause();\r\n        //     return;\r\n        // }\r\n    }\r\n\r\n    clear() {\r\n        this.gl.clearColor(\r\n            this.backgroundColor.r,\r\n            this.backgroundColor.g,\r\n            this.backgroundColor.b,\r\n            this.backgroundColor.a\r\n        );\r\n        this.gl.clear(this.gl.COLOR_BUFFER_BIT);\r\n    }\r\n}","// import { WebGLDebugUtils } from '../libs/webgl-debug'\r\n\r\nfunction logGLCall(functionName, args) {\r\n\tconsole.log(\"gl.\" + functionName + \"(\" +\r\n\t\tWebGLDebugUtils.glFunctionArgsToString(functionName, args) + \")\");\r\n}\r\n\r\nfunction validateNoneOfTheArgsAreUndefined(functionName, args) {\r\n\tfor (var ii = 0; ii < args.length; ++ii) {\r\n\t\tif (args[ii] === undefined) {\r\n\t\t\tconsole.error(\"undefined passed to gl.\" + functionName + \"(\" +\r\n\t\t\t\tWebGLDebugUtils.glFunctionArgsToString(functionName, args) + \")\");\r\n\t\t}\r\n\t}\r\n}\r\n\r\nfunction logAndValidate(functionName, args) {\r\n\tlogGLCall(functionName, args);\r\n\tvalidateNoneOfTheArgsAreUndefined(functionName, args);\r\n}\r\n\r\nfunction throwOnGLError(err, funcName, args) {\r\n\tthrow WebGLDebugUtils.glEnumToString(err) + \" was caused by call to: \" + funcName;\r\n};\r\n\r\nexport function createDebugGl(gl: WebGLRenderingContext){\r\n    return WebGLDebugUtils.makeDebugContext(gl, throwOnGLError, logAndValidate);\r\n}","import { colorShapeVertexShader, colorShapeFragmentShader, spriteVertexShader, spriteFragmentShader, colorAndMaskTimelineFragmentShader, maskTimelineFragmentShader, colorTimelineFragmentShader, timelineVertexShader } from './Programs'\r\nimport { Color } from './Color'\r\nimport { Renderer } from './Renderer'\r\nimport { Timeline } from './Timeline/Timeline';\r\nimport { createDebugGl } from './DebugGl'\r\nimport { _Color, Matrix } from './types';\r\nimport { computeMatrix } from './Matrix';\r\nimport { createBufferInfoFromBuffers } from './BufferInfo'\r\nimport { Spritesheet } from './AssetManagement/Spritesheet';\r\nimport { Sprite } from './Renderable/Sprite';\r\n// import * as twgl from './twgl.js/dist/4.x/twgl';\r\n\r\ninterface TextureBuffer {\r\n\ttexture: WebGLTexture;\r\n\tsrc: Spritesheet | Sprite;\r\n}\r\n\r\nexport class Base {\r\n\tcanvas: HTMLCanvasElement;\r\n\ttextCanvas: HTMLCanvasElement;\r\n\tgl: WebGLRenderingContext;\r\n\r\n\trenderer: Renderer;\r\n\r\n\tunitBuffer: WebGLBuffer;\r\n\r\n\t_lastUsedProgram: twgl.ProgramInfo;\r\n\t_lastUsedTexture: WebGLTexture;\r\n\t_lastUsedFramebuffer: WebGLFramebuffer;\r\n\r\n\tprojectionMatrixAndSize: Matrix;\r\n\r\n\tdebug: boolean;\r\n\r\n\tdefaultShapeProgram: twgl.ProgramInfo;\r\n\tdefaultSpriteProgram: twgl.ProgramInfo;\r\n\tmaskProgram: twgl.ProgramInfo;\r\n\tcolorProgram: twgl.ProgramInfo;\r\n\tcolorAndMaskProgram: twgl.ProgramInfo;\r\n\r\n\tdefaultBufferInfo: twgl.BufferInfo;\r\n\tdefaultSpriteBufferInfo: twgl.BufferInfo;\r\n\r\n\taudioContext: AudioContext;\r\n\r\n\ttextureBuffers: Array<TextureBuffer>;\r\n\tmaxTextureBufferSize: number;\r\n\r\n\r\n\tconstructor(\r\n\t\tdebug: boolean = false,\r\n\t\twidth: number,\r\n\t\theight: number,\r\n\t\tcanvas_id: string,\r\n\t\tfps: number = 25,\r\n\t\twebgl2: boolean = false,\r\n\t\tbgC: _Color | Color = [-1, -1, -1, -1],\r\n\t\tmaxTextureBufferSize: number = 20\r\n\t) {\r\n\t\tthis.canvas = <HTMLCanvasElement>document.getElementById(canvas_id);\r\n\t\tif (this.canvas.nodeName != \"CANVAS\") {\r\n\t\t\tthis.canvas = document.createElement(\"canvas\");\r\n\t\t\tthis.textCanvas = document.createElement('canvas');\r\n\t\t\tthis.textCanvas.style.display = 'none';\r\n\t\t\tdocument.getElementById(canvas_id).appendChild(this.canvas);\r\n\t\t\tdocument.getElementById(canvas_id).appendChild(this.textCanvas);\r\n\t\t}\r\n\r\n\t\tthis.gl = <WebGLRenderingContext>(\r\n\t\t\tthis.canvas.getContext(webgl2 ? \"webgl2\" : \"webgl\", { depth: false })\r\n\t\t);\r\n\r\n\t\tif (!this.gl) {\r\n\t\t\tconsole.error(`Brak wsparcia dla ${webgl2 ? \"webgl2\" : \"webgl\"}.`);\r\n\t\t\treturn;\r\n\t\t}\r\n\r\n\t\tif (debug) {\r\n\t\t\tthis.gl = createDebugGl(this.gl);\r\n\t\t}\r\n\t\tthis.debug = debug;\r\n\r\n\t\tthis.setCanvasSize(width, height);\r\n\r\n\t\tthis.renderer = new Renderer(this, fps, width, height, bgC instanceof Color ? bgC : new Color(bgC));\r\n\t\tthis.projectionMatrixAndSize = computeMatrix(this.renderer.projectionMatrix, new Float32Array(9), {x: 0, y: height}, {x: 1, y: -1}, width, height, {x: 0, y: 0}, 0, {x: 0, y: 0});\r\n\r\n\t\tthis.gl.frontFace(this.gl.CW);\r\n\t\tthis.gl.enable(this.gl.BLEND);\r\n\t\tthis.gl.blendFunc(this.gl.ONE, this.gl.ONE_MINUS_SRC_ALPHA);\r\n\t\tthis.gl.pixelStorei(this.gl.UNPACK_PREMULTIPLY_ALPHA_WEBGL, true);\r\n\r\n\t\tthis.defaultShapeProgram = twgl.createProgramInfo(this.gl, [colorShapeVertexShader, colorShapeFragmentShader])\r\n\t\tthis.defaultSpriteProgram = twgl.createProgramInfo(this.gl, [spriteVertexShader, spriteFragmentShader]);\r\n\t\tthis.maskProgram = twgl.createProgramInfo(this.gl, [timelineVertexShader, maskTimelineFragmentShader])\r\n\t\tthis.colorProgram = twgl.createProgramInfo(this.gl, [timelineVertexShader, colorTimelineFragmentShader]);\r\n\t\tthis.colorAndMaskProgram = twgl.createProgramInfo(this.gl, [timelineVertexShader, colorAndMaskTimelineFragmentShader]);\r\n\t\tthis.unitBuffer = twgl.createBufferFromArray(this.gl, new Float32Array([0, 0, 0, 1, 1, 0, 1, 1]), 'Float32Array');\r\n\t\tthis.defaultBufferInfo = createBufferInfoFromBuffers(this.gl, { aPos: this.unitBuffer });\r\n\t\tthis.defaultSpriteBufferInfo = createBufferInfoFromBuffers(this.gl, { aPos: this.unitBuffer, aTexCoords: this.unitBuffer });\r\n\t\tthis.lastUsedFramebuffer = null;\r\n\r\n\t\tthis.maxTextureBufferSize = maxTextureBufferSize;\r\n\t\tthis.textureBuffers = [];\r\n\r\n\t\tthis.audioContext = new AudioContext();\r\n\t}\r\n\r\n\tsetCanvasSize(width, height) {\r\n\t\tthis.canvas.width = width;\r\n\t\tthis.canvas.height = height;\r\n\t\tthis.gl.viewport(0, 0, this.canvas.width, this.canvas.height);\r\n\t}\r\n\r\n\tget mainTimeline() {\r\n\t\treturn this.renderer.mainTimeline;\r\n\t}\r\n\r\n\tset mainTimeline(value: Timeline) {\r\n\t\tif (!(value instanceof Timeline)) {\r\n\t\t\treturn;\r\n\t\t}\r\n\t\tthis.renderer.mainTimeline = value;\r\n\t}\r\n\r\n\tplay() {\r\n\t\tthis.renderer.play();\r\n\t}\r\n\r\n\tpause() {\r\n\t\tthis.renderer.pause();\r\n\t}\r\n\r\n\tget lastUsedProgram() {\r\n\t\treturn this._lastUsedProgram;\r\n\t}\r\n\r\n\tset lastUsedProgram(value: twgl.ProgramInfo) {\r\n\t\tthis._lastUsedProgram = value;\r\n\t\tthis.gl.useProgram(value.program);\r\n\t}\r\n\r\n\tget lastUsedTexture() {\r\n\t\treturn this._lastUsedTexture;\r\n\t}\r\n\r\n\tset lastUsedTexture(value: WebGLTexture) {\r\n\t\tthis._lastUsedTexture = value;\r\n\t\tthis.gl.activeTexture(this.gl.TEXTURE0);\r\n\t\tthis.gl.bindTexture(this.gl.TEXTURE_2D, value);\r\n\t}\r\n\r\n\tget lastUsedFramebuffer() {\r\n\t\treturn this._lastUsedFramebuffer;\r\n\t}\r\n\r\n\tset lastUsedFramebuffer(value: WebGLFramebuffer) {\r\n\t\tthis._lastUsedFramebuffer = value;\r\n\t\tthis.gl.bindFramebuffer(this.gl.FRAMEBUFFER, value);\r\n\t}\r\n\r\n\tloadTexture(img: ImageData | HTMLImageElement, src: Spritesheet | Sprite): WebGLTexture {\r\n\t\tlet buffer: TextureBuffer;\r\n\t\tif (this.textureBuffers.length < this.maxTextureBufferSize) {\r\n\t\t\tbuffer = {\r\n\t\t\t\ttexture: this.gl.createTexture(),\r\n\t\t\t\tsrc: src\r\n\t\t\t}\r\n\r\n\t\t\tthis.gl.bindTexture(this.gl.TEXTURE_2D, buffer.texture);\r\n\t\t\tthis.gl.texParameteri(\r\n\t\t\t\tthis.gl.TEXTURE_2D,\r\n\t\t\t\tthis.gl.TEXTURE_WRAP_S,\r\n\t\t\t\tthis.gl.CLAMP_TO_EDGE\r\n\t\t\t);\r\n\t\t\tthis.gl.texParameteri(\r\n\t\t\t\tthis.gl.TEXTURE_2D,\r\n\t\t\t\tthis.gl.TEXTURE_WRAP_T,\r\n\t\t\t\tthis.gl.CLAMP_TO_EDGE\r\n\t\t\t);\r\n\t\t\tthis.gl.texParameteri(\r\n\t\t\t\tthis.gl.TEXTURE_2D,\r\n\t\t\t\tthis.gl.TEXTURE_MIN_FILTER,\r\n\t\t\t\tthis.gl.NEAREST\r\n\t\t\t);\r\n\t\t\tthis.gl.texParameteri(\r\n\t\t\t\tthis.gl.TEXTURE_2D,\r\n\t\t\t\tthis.gl.TEXTURE_MAG_FILTER,\r\n\t\t\t\tthis.gl.NEAREST\r\n\t\t\t);\r\n\t\t\tthis.gl.texImage2D(\r\n\t\t\t\tthis.gl.TEXTURE_2D,\r\n\t\t\t\t0,\r\n\t\t\t\tthis.gl.RGBA,\r\n\t\t\t\tthis.gl.RGBA,\r\n\t\t\t\tthis.gl.UNSIGNED_BYTE,\r\n\t\t\t\timg\r\n\t\t\t);\r\n\t\t} else {\r\n\t\t\tbuffer = this.textureBuffers.shift();\r\n\t\t\tbuffer.src.texture = null;\r\n\t\t\tbuffer.src = src;\r\n\t\t\tthis.gl.bindTexture(this.gl.TEXTURE_2D, buffer.texture);\r\n\t\t\tthis.gl.texImage2D(\r\n\t\t\t\tthis.gl.TEXTURE_2D,\r\n\t\t\t\t0,\r\n\t\t\t\tthis.gl.RGBA,\r\n\t\t\t\tthis.gl.RGBA,\r\n\t\t\t\tthis.gl.UNSIGNED_BYTE,\r\n\t\t\t\timg\r\n\t\t\t);\r\n\t\t}\r\n\t\tthis.textureBuffers.push(buffer);\r\n\t\treturn buffer.texture;\r\n\t}\r\n\r\n\tupdateTextureBuffer(src: Spritesheet | Sprite) {\r\n\t\tlet buffer = this.textureBuffers.findIndex(element => {\r\n\t\t\treturn element === src;\r\n\t\t})\r\n\t\tif (buffer !== -1) {\r\n\t\t\tthis.textureBuffers.push(this.textureBuffers.splice(buffer, 1)[0]);\r\n\t\t}\r\n\t}\r\n}\r\n"],"names":[],"mappings":"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"}